"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var child_process_1 = require("child_process");
var chai_1 = require("chai");
var mocha_1 = require("mocha");
var urls_1 = require("../../src/urls");
var constants_1 = require("../constants");
var functions_1 = require("../functions");
mocha_1.describe('Test clasp apis functions', function () {
    before(functions_1.setup);
    mocha_1.it('should list apis correctly', function () {
        var result = child_process_1.spawnSync(constants_1.CLASP, ['apis', 'list'], { encoding: 'utf8' });
        chai_1.expect(result.stdout).to.contain('# Currently enabled APIs:');
        chai_1.expect(result.stdout).to.contain('# List of available APIs:');
        chai_1.expect(result.stderr).to.equal('');
        chai_1.expect(result.status).to.equal(0);
    });
    mocha_1.it('should ask for an API when trying to enable', function () {
        var result = child_process_1.spawnSync(constants_1.CLASP, ['apis', 'enable'], { encoding: 'utf8' });
        chai_1.expect(result.stderr).to.contain('An API name is required.');
        chai_1.expect(result.status).to.equal(1);
    });
    mocha_1.it('should enable sheets', function () {
        var result = child_process_1.spawnSync(constants_1.CLASP, ['apis', 'enable', 'sheets'], { encoding: 'utf8' });
        chai_1.expect(result.stdout).to.contain('Enabled sheets API.');
        chai_1.expect(result.stderr).to.equal('');
        chai_1.expect(result.status).to.equal(0);
    });
    mocha_1.it('should give error message for non-existent API', function () {
        var result = child_process_1.spawnSync(constants_1.CLASP, ['apis', 'enable', 'fakeApi'], { encoding: 'utf8' });
        chai_1.expect(result.stderr).to.contain('API fakeApi doesn\'t exist. Try \'clasp apis enable sheets\'.');
        chai_1.expect(result.status).to.equal(1);
    });
    mocha_1.it('should ask for an API when trying to disable', function () {
        var result = child_process_1.spawnSync(constants_1.CLASP, ['apis', 'disable'], { encoding: 'utf8' });
        chai_1.expect(result.stderr).to.contain('An API name is required.');
        chai_1.expect(result.status).to.equal(1);
    });
    mocha_1.it('should disable apis correctly', function () {
        var result = child_process_1.spawnSync(constants_1.CLASP, ['apis', 'disable', 'sheets'], { encoding: 'utf8' });
        chai_1.expect(result.stdout).to.contain('Disabled sheets API.');
        chai_1.expect(result.stderr).to.equal('');
        chai_1.expect(result.status).to.equal(0);
    });
    mocha_1.it('should show suggestions for using clasp apis', function () {
        var result = child_process_1.spawnSync(constants_1.CLASP, ['apis'], { encoding: 'utf8' });
        chai_1.expect(result.stdout).to.contain("# Try these commands:\n- clasp apis list\n- clasp apis enable slides\n- clasp apis disable slides");
        chai_1.expect(result.stderr).to.equal('');
        chai_1.expect(result.status).to.equal(0);
    });
    mocha_1.it('should error with unknown subcommand', function () {
        var result = child_process_1.spawnSync(constants_1.CLASP, ['apis', 'unknown'], { encoding: 'utf8' });
        chai_1.expect(result.stderr).to.contain("Unknown command");
        chai_1.expect(result.status).to.equal(1);
    });
    mocha_1.it('should open APIs dashboard', function () {
        var result = child_process_1.spawnSync(constants_1.CLASP, ['apis', '--open'], { encoding: 'utf8' });
        chai_1.expect(result.stdout).to.contain(urls_1.URL.APIS(constants_1.PROJECT_ID));
        chai_1.expect(result.stderr).to.equal('');
        chai_1.expect(result.status).to.equal(0);
    });
    after(functions_1.cleanup);
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBpcy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImFwaXMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSwrQ0FBMEM7QUFDMUMsNkJBQThCO0FBQzlCLCtCQUFxQztBQUNyQyx1Q0FBcUM7QUFDckMsMENBQWlEO0FBQ2pELDBDQUE4QztBQUU5QyxnQkFBUSxDQUFDLDJCQUEyQixFQUFFO0lBQ3BDLE1BQU0sQ0FBQyxpQkFBSyxDQUFDLENBQUM7SUFDZCxVQUFFLENBQUMsNEJBQTRCLEVBQUU7UUFDL0IsSUFBTSxNQUFNLEdBQUcseUJBQVMsQ0FDdEIsaUJBQUssRUFBRSxDQUFDLE1BQU0sRUFBRSxNQUFNLENBQUMsRUFBRSxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsQ0FDOUMsQ0FBQztRQUNGLGFBQU0sQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBRSxDQUFDLE9BQU8sQ0FBQywyQkFBMkIsQ0FBQyxDQUFDO1FBQzlELGFBQU0sQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBRSxDQUFDLE9BQU8sQ0FBQywyQkFBMkIsQ0FBQyxDQUFDO1FBQzlELGFBQU0sQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUNuQyxhQUFNLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDcEMsQ0FBQyxDQUFDLENBQUM7SUFDSCxVQUFFLENBQUMsNkNBQTZDLEVBQUU7UUFDaEQsSUFBTSxNQUFNLEdBQUcseUJBQVMsQ0FDdEIsaUJBQUssRUFBRSxDQUFDLE1BQU0sRUFBRSxRQUFRLENBQUMsRUFBRSxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsQ0FDaEQsQ0FBQztRQUNGLGFBQU0sQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBRSxDQUFDLE9BQU8sQ0FBQywwQkFBMEIs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