"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var child_process_1 = require("child_process");
var chai_1 = require("chai");
var mocha_1 = require("mocha");
var constants_1 = require("../constants");
var functions_1 = require("../functions");
mocha_1.describe('Test clasp deploy function', function () {
    before(functions_1.setup);
    // Could fail to to maximum deployments (20)
    // TODO: skip test if at maximum
    mocha_1.it('should deploy correctly', function () {
        var result = child_process_1.spawnSync(constants_1.CLASP, ['deploy'], { encoding: 'utf8' });
        if (result.stderr) {
            var err1 = 'Scripts may only have up to 20 versioned deployments at a time';
            var err2 = 'Currently just one deployment can be created at a time';
            var re = "(?:" + err1 + "|" + err2 + ")";
            chai_1.expect([result.stderr]).to.match(new RegExp(re));
            chai_1.expect(result.status).to.equal(1);
        }
        else {
            chai_1.expect(result.stdout).to.contain('Created version ');
            chai_1.expect(result.status).to.equal(0);
        }
    });
    after(functions_1.cleanup);
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGVwbG95LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiZGVwbG95LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsK0NBQTBDO0FBQzFDLDZCQUE4QjtBQUM5QiwrQkFBcUM7QUFDckMsMENBQXFDO0FBQ3JDLDBDQUE4QztBQUU5QyxnQkFBUSxDQUFDLDRCQUE0QixFQUFFO0lBQ3JDLE1BQU0sQ0FBQyxpQkFBSyxDQUFDLENBQUM7SUFDZCw0Q0FBNEM7SUFDNUMsZ0NBQWdDO0lBQ2hDLFVBQUUsQ0FBQyx5QkFBeUIsRUFBRTtRQUM1QixJQUFNLE1BQU0sR0FBRyx5QkFBUyxDQUN0QixpQkFBSyxFQUFFLENBQUMsUUFBUSxDQUFDLEVBQUUsRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLENBQ3hDLENBQUM7UUFDRixJQUFJLE1BQU0sQ0FBQyxNQUFNLEVBQUU7WUFDakIsSUFBTSxJQUFJLEdBQUcsZ0VBQWdFLENBQUM7WUFDOUUsSUFBTSxJQUFJLEdBQUcsd0RBQXdELENBQUM7WUFDdEUsSUFBTSxFQUFFLEdBQUcsUUFBTSxJQUFJLFNBQUksSUFBSSxNQUFHLENBQUM7WUFDakMsYUFBTSxDQUFDLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQyxJQUFJLE1BQU0sQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBQ2pELGFBQU0sQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUNuQzthQUFNO1lBQ0wsYUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDLGtCQUFrQixDQUFDLENBQUM7WUFDckQsYUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQ25DO0lBQ0gsQ0FBQyxDQUFDLENBQUM7SUFDSCxLQUFLLENBQUMsbUJBQU8sQ0FBQyxDQUFDO0FBQ2pCLENBQUMsQ0FBQyxDQUFDIn0=